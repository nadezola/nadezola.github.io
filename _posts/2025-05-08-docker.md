---
layout: post
title:  "Docker in Practice"
date:   2025-05-08
categories: DevTools
---

## Getting Started with Docker: A Brief and Practical Introduction

Docker allows you to deploy apps without setup difficulties or dependency issues. 
It packages everything into portable containers that run stable across environments. 
Simplify your deployment, scale applications, and ensure consistent behavior!

### üê≥ Docker Hub

+ A public registry (platform) for downloading **docker image** (_Dockerfile_)
+ Read-only platform
+ _Ex.:_ An image that includes _Ubuntu with CUDA 10.2 pre-installed_

### üê≥ The Docker Pipeline

<img src="/assets/posts/docker-1.png" style="display: block; margin: 0 auto;"/>
<br>

### ‚úÖ  Simple Start from a Dockerfile

+ **Build** a **docker image** from Dockerfile and tag it as 'towards-simple-world':

```bash
docker build -t towards-simple-world docker/    # 'docker/' is the folder where the Dockerfile is located   

# or (if the Dockerfile uses arguments):
docker build --build-arg IMAGE_NAME=nvidia/cuda -t towards-simple-world docker/  
```

+ **Run** a **docker container** from the docker image:

```bash
docker run --rm                          # Automatically remove the container when it exits
           --gpus all                    # Give the container access to all available GPUs 
           -v $(pwd)/:/app               # Mount current directory to /app in the container
           -w /app                       # Set working directory to /app
           -ti towards-simple-world      # Use tagged Docker image
           /bin/bash                     # Open the bash shell inside the starting container
```

+ **Run** a **python program** inside the docker container:

```bash
python file.py  # The container is running, now you can execute the Python file
```
<br>

### ‚úÖ Docker in PyCharm with Debugging Support

To debug and run the program in PyCharm as usual, you need to create the correct **Python Interpreter**.

+ Open Interpreter Settings
  - Go to **File ‚Üí Settings** (`Ctrl + Alt + S`)
  - Navigate to **Project ‚Üí Python Interpreter**
  - Click **Add Interpreter** ‚Üí select **Docker**

+ Configure Docker Interpreter
  + **Image**: select the desired docker image  
  + **Python Interpreter Path**: `python`  
  + **Interpreter Type**: `Remote Python Docker`

+ Configure Run/Debug Configuration
  - Go to **Run ‚Üí Edit Configurations**
  - Click **Add New** ‚Üí choose **Python**
  - Set up as usual, but make sure to select the docker interpreter
  - **Working directory**: `/app`
  - **Path mappings**:  
    - Project root ‚Üí `/app`

+ Docker Container Settings
  - Click the **Configuration** button in Docker settings
  - Add docker run options:
```
  --rm --gpus all -v $(pwd)/:/app  -w /app
```
<br>

### üõ†Ô∏è Most Useful Docker Commands

| Command                                    | Description                                                                                                                           |
|:-------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------|
| `docker build -t my-image .`               | Build a docker image from a Dockerfile located in the current directory<br> and tag it (-t) as `my-image`                             |
| `docker run -ti my-image /bin/bash`        | Run a container from a docker image with a terminal session (-t),<br> keeping stdin open (-i) for input, and launching the bash shell |
| `docker exec -ti <container-id> /bin/bash` | Open a terminal (-t) with the bash shell inside a running container,<br> keeping stdin open (-i) for input                            |
| `docker volume create my_volume`           | Create a new volume                                                                                                                   |
| **Check It**                               |                                                                                                                                       |
| `docker images`                            | List all local docker images                                                                                                          |
| `docker ps`                                | List all running containers                                                                                                           |
| `docker ps -a`                             | List all containers, including stopped ones                                                                                           |
| `docker logs <container-id>`               | View logs of a container                                                                                                              |
| `docker top <container_id>`                | Show running processes inside container                                                                                               |
| `docker volume ls`                         | List volumes                                                                                                                          |
| **Modify and Save**                        |                                                                                                                                       |
| `docker pull <image>`                      | Download a docker image from DockerHub                                                                                                |
| `docker push <image>`                      | Upload a docker image to DockerHub                                                                                                    |
| `docker tag <source> <target>`             | Tag an image with a new name or version.                                                                                              |
| `docker commit <container_id> my-image`    | Save changes inside a running container (e.g., installed packages)<br> to a docker image                                              |
| **Cleanup**                                |                                                                                                                                       |
| `docker stop <container-id>`               | Stop a running container                                                                                                              |
| `docker rm <container-id>`                 | Remove a stopped container                                                                                                            |
| `docker rmi <image-id>`                    | Remove a docker image                                                                                                                 |
| `docker system prune`                      | Remove unused data (containers, images, networks)                                                                                     |
| `docker image prune`                       | Remove unused images                                                                                                                  |
| `docker container prune`                   | Remove stopped containers                                                                                                             |


